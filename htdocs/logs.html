<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
	<link rel="apple-touch-icon" href="apple-touch-icon-iphone.png" />
	<link rel="apple-touch-icon" sizes="72x72" href="apple-touch-icon-ipad.png" />
	<link rel="apple-touch-icon" sizes="114x114" href="apple-touch-icon-iphone4.png" />

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<!-- <meta name="viewport" content = "height = device-height, width = 420, user-scalable = no" />  -->
	<title>* * GardenPi * *</title>

	<script language="javascript" type="text/javascript" src="flot-master/jquery.js"></script>
	<script language="javascript" type="text/javascript" src="flot-master/jquery.flot.js"></script>
	<script language="javascript" type="text/javascript" src="flot-master/jquery.flot.time.js"></script>
	<script type="text/javascript">

	$(function() {
			console.log('plop')
    	$.ajax({
        	url:"GardenPy_Logs.txt",
        	context:document.body
    	}).done(function (data) {
			dataArray = parseCSV(data)

			var d1 = [];
			var d2 = [];
			var d3 = [];
			var d4 = [];
			var d5 = [];
			var d6 = [];
			var d7 = [];

			var i = 0;
			dataArray.forEach (function(line){
				i+=1;
			// console.log(line)
			var theTime = new Date(line[0]);
				d1.push([theTime, line[1]<50?line[1]:0]); //temp
				d2.push([theTime, line[2]<50?line[2]:0]); //humiditÃ©
				if (line[3]=='True') d3.push([theTime, 34]);
				if (line[4]=='True') d4.push([theTime, 33]);
				if (line[5]=='True') d5.push([theTime, 32]);
				if (line[6]=='True') d6.push([theTime, 31]);
				if (line[7]=='True') d7.push([theTime, 30]);
				// d3.push([i, Math.sin(i)]);

			});
		
		$.plot("#placeholder",  [{
			data: d1,
			lines: { show: true }
		}, {
			data: d2,
			lines: { show: true }
		}, {
			data: d3,
			points: { show: true }
		}, {
			data: d4,
			points: { show: true }
		}, {
			data: d5,
			points: { show: true }
		}, {
			data: d6,
			points: { show: true }
		}, {
			data: d7,
			points: { show: true }
		}], {
					xaxis: { mode: "time" }
		});
				console.log('done')
    	});



	});

	function parseCSV(str) {
    var arr = [];
    var quote = false;  // true means we're inside a quoted field

    // iterate over each character, keep track of current row and column (of the returned array)
    for (var row = col = c = 0; c < str.length; c++) {
        var cc = str[c], nc = str[c+1];        // current character, next character
        arr[row] = arr[row] || [];             // create a new row if necessary
        arr[row][col] = arr[row][col] || '';   // create a new column (start with empty string) if necessary

        // If the current character is a quotation mark, and we're inside a
        // quoted field, and the next character is also a quotation mark,
        // add a quotation mark to the current column and skip the next character
        if (cc == '"' && quote && nc == '"') { arr[row][col] += cc; ++c; continue; }  

        // If it's just one quotation mark, begin/end quoted field
        if (cc == '"') { quote = !quote; continue; }

        // If it's a comma and we're not in a quoted field, move on to the next column
        if (cc == ',' && !quote) { ++col; continue; }

        // If it's a newline and we're not in a quoted field, move on to the next
        // row and move to column 0 of that new row
        if (cc == '\n' && !quote) { ++row; col = 0; continue; }

        // Otherwise, append the current character to the current column
        arr[row][col] += cc;
    }
    return arr;
}

	</script>
	</script>

	<style type="text/css">
		.demo-container {
		    width: 100%;
		    height: 450px;
		    padding: 20px 15px 15px;
		    margin: 15px auto 30px;
		    border: 1px solid rgb(221, 221, 221);
		    background: linear-gradient(rgb(246, 246, 246) 0px, rgb(255, 255, 255) 50px) repeat scroll 0% 0% transparent;
		    box-shadow: 0px 3px 10px rgba(0, 0, 0, 0.15);
		}
		.demo-placeholder {
			width: 100%;
			height: 100%;
			font-size: 14px;
			line-height: 1.2em;
		}

	</style>
</head>
<body>
	<div id="content" align="center">
		<div class="demo-container">
			<div id="placeholder" class="demo-placeholder"></div>
		</div>
	</div>
	<div id="nav"><a href="index.html">Dashboard</a> <a href="config.html">config</a></div>
</body>
</html>
